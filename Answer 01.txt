with customers_table_with_customerid AS (
	SELECT 

	    CONCAT(first_name,'_',last_name) AS customer_id,
	    id, 
	    created_at, 
	    updated_at, 
	    first_name,
	    last_name,
	FROM customers
);

with customers_table_with_row_number AS (
	SELECT 
	    *,
	    ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY id DESC) AS row_number
	FROM customers_table_with_customerid
)


SELECT  *
FROM customers_table_with_row_number
JOIN orders 
ON orders.id=customers_table_with_row_number.id;
WHERE    
customers_table_with_row_number.row_number = 1
AND
orders.created_at >= DATEADD(day, -1, GETDATE())
